---
title: 支付漏洞
toc: false
date: 2021-03-25 11:13:48
description: 支付漏洞
tags: Web安全
categories: Web安全
---

## 0x01 快捷支付原理

* 浏览器进行跳转通知：基于用户访问的浏览器（基本没了）
* 服务器端异步通知

## 0x02 支付漏洞

逻辑漏洞，支付三部曲：订购、订单、付款

* 修改支付价格
  * 三个步骤中随意一个步骤进行修改价格测试，可以尝试小金额或负数
* 修改支付状态
  * 订单完成——未完成
* 修改订单数量
  * 一支笔1元，买0支或者-1支
* 修改附属值
  * 优惠券，修改金额大于或等于商品的价格，或者直接修改为负数
* 越权支付
  * 存在user=id这种传参，修改id，使用别人的钱包付钱
* 无限制试用
  * 试用的参数为2，正常购买的参数为1，购买参数2

## 0x03 挖掘

* 找到关键的数据包
* 分析数据包

## 0x04 防御方法

* 后端检测每一项值，包括支付状态
* 校验价格、数量参数
* 与第三方支付平台检查
* 支付参数进行MD5加密、解密、数字签名及验证
* 金额超过阈值，进行人工审核